<!DOCTYPE html>
{% load i18n %}

<html>
    <head>
        <title>
            {%block title%}
                Main
            {%endblock%}
        </title>        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery-1.9.1.js"></script>        
        <script type="text/javascript" src="{{ STATIC_URL }}bootstrap/js/bootstrap.js"></script>
         <script src="{{ STATIC_URL }}bootstrap/js/bootstrap.min.js"></script>
        <link href="{{ STATIC_URL }}bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
       


        <style type="text/css">
          html,body {
            height: 100%;            
            padding-top: 5px;
            padding-bottom: 40px;
            padding-left: 40px;
            padding-right: 40px;
          }
          .sidebar-nav {
            padding: 11px 0;
          }
          
        .alert_block {
            position:fixed;
            bottom:30%;
            left: 0%;
            padding:6px;
            text-align:center;
            z-index:9999999999;
            display:block;      
        }

        .file_block {
            background-color: #fff;
            color: #000;        
        }
          #wrap {
            min-height: 90%;
            height: auto !important;
            height: 100%;
            /* Negative indent footer by it's height */
            margin: 0 auto -60px;
          }

          /* Set the fixed height of the footer here */
          #push,
          #footer {
            height: 60px;
          }
          #footer {
            background-color: #f5f5f5;
          }
            
          @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
              float: none;
              padding-left: 5px;
              padding-right: 5px;
            }
            #footer {
              margin-left: -20px;
              margin-right: -20px;
              padding-left: 20px;
              padding-right: 20px;
            }
          }
          
        #wrap > .container {
                padding-top: 60px;
              }
              .container .credit {
                margin: 20px 0;
              }
        
              code {
                font-size: 80%;
              }

        #upBlock {
            position:fixed;
            bottom:100px;
            left: 10%;
            color:#000000;
            padding:6px;
            text-align:center;
            z-index:9999999999;
            display:none;
        }
        

    div, button {clear:both;}
     .pass:before {
          content: 'PASS: ';
          color:  blue;
          font-weight: bold;
      }

      .fail:before {
          content: 'FAIL: ';
          color: red;
          font-weight: bold;
      }

    hr {
        border: none; /* Убираем границу */
        background-color: #cccccc; /* Цвет линии */
        color: #cccccc; /* Цвет линии для IE6-7 */
        height: 1px; /* Толщина линии */
       }

        </style>
    </head>
    <body>
<div id="wrap">
    <div class="alert_block" id="alert_block">
        {% block messages %}
                {% if messages %}
                    <ul class="messages">
                        {% for message in messages %}                        
                            <li{% if message.tags %} class="alert alert-{{ message.tags }}"{% endif %}>
                                <button type="button" class="close" id="close_alert" data-dismiss="alert">&times;</button>                            
                                {{ message }}
                            <script type = "text/javascript">
                                var mb = $("#alert_block")
                                mb.animate({'left':"5%"}, {duration:1200}).animate({'opacity':0}, {duration:6100});
                                var timerID = setTimeout(function () {
                                    $("#close_alert").trigger("click");
                                    mb.css('opacity',1)
                                },12000);
                                mb.mouseenter(function() {
                                    clearTimeout(timerID);
                                    mb.stop();
                                    mb.css('opacity',1);
                                });
                            </script>
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endblock %}
    </div>
    
        <script src="{{ STATIC_URL }}bootstrap/js/bootstrap.min.js"></script>
        
<!--<input type="button" value="Goods Uncover" class="btn btn-success btn-small">-->

{%block application%}
<div align="right" id="auth">
    {% if not user.is_authenticated %}
        <a href="/login/">SignIn</a>
    {%else%}
        <a href="/logout/">Logout</a>
    {%endif%}
</div>    


            <div class="tabbable" id="mainContent"> <!-- Only required for left/right tabs -->
                  <ul class="nav nav-tabs" id="myTab" >
                        <li class={{active.0}}><a id=1 href="#main" data-toggle="tab"><i class="icon-search"></i>Поиск</a></li>
                        <li class={{active.1}}><a id=2 href="#descr" data-toggle="tab"><i class="icon-list"></i>Результаты</a></li>        
                        <li class=""><a id=3 href="#comments" data-toggle="tab"><i class="icon-user"></i>Комментарии</a></li>
                  </ul>
                  <div class="tab-content">
                        <div class="tab-pane {{active.0}}" id="main">
                            {%include "last_barcode.html"%}          
                        </div>
                        
                        <div class="tab-pane {{active.1}}" id="descr"> 
                            <div class="row-fluid">                             
                            <div class="span2" id="12345">  
                                     <div class="well sidebar-nav">
                                        <ul class="nav nav-list">
                                            <li><a href="#">Yandex mareket</a></li>
                                              <li><a href="#">Другой сервис</a></li>
                                              <li><a href="#">Другой сервис</a></li>
                                              <li><a href="#">Другой сервис</a></li>                      
                                        </ul>
                                      </div><!--/.well -->
                            <button type="button" onclick="$('.sidebar-nav').toggle('slow')" class="btn btn-success btn-small" ><i class="icon-resize-vertical icon-white"></i> Источники </button>                                      
                            </div> 
                            
                             <div class="span9 offset2">  
                                
                                <h4>Штрих-код:</h4> {{barcode}} </br>            
                                <h4>Название:</h4> {{title}}</br>
                                <h4>Описание:</h4> {%for d in data%}
                                                        {{d}}<br>
                                                        <hr>
                                                    {%endfor%}                                                                    
                                 </br> 
                            </div> 
                        </div>
                        </div> <!--tab-pane-->        
                    
                        
                        <div  class="tab-pane" id="comments" >
                            <div class="row-fluid">                            
                                 <div class="span2">  
                                             <div class="well sidebar-nav">
                                                <ul class="nav nav-list">
                                                    <li><a href="#">Yandex mareket</a></li>
                                                      <li><a href="#">Другой сервис</a></li>
                                                      <li><a href="#">Другой сервис</a></li>
                                                      <li><a href="#">Другой сервис</a></li>                      
                                                </ul>
                                              </div><!--/.well -->
                                <button type="button" id="hide" onclick="$('.sidebar-nav').toggle('slow');" class="btn btn-success btn-small" ><i class="icon-resize-vertical icon-white"></i> Источники </button>
                                </div> 
                                 <div class="span9 offset2">           
                                    <form>
                                        {{commentform}}
                                        {% if commentform%}
                                            </br><input type="submit" value="Отправить" class="btn btn-success btn-medium">
                                        {%endif%}
                                    </form>
                                     <div  id="comm">                                     
                                        {%for com in ms%}
                                            <b>Имя:</b> {{com.Author}} <br>
                                            <b>Текст:</b> {{com.Text|linebreaksbr}} <br><br>
                                        {%endfor%}
                                    </div>
                                </div>
                            </div>                           
                        </div> <!--tabpane-->
                  </div> <!--tabcontent-->
                </div> <!--tabtable-->
{%endblock%}

<script>

                              

                var page = 2
                function newPage(){
                    if(page <= {{ ms.paginator.num_pages }}){
                            $("#upBlock").css('display','block');
                        
                        setTimeout(function () {
                            $.get("/{{barcode}}/?page="+page,function(data){
                                $("#comm").append($("#comm",data)).end();
                            },'html');
                            $("#upBlock").css('display','none');
                            page = page + 1;
                        },100);
                    }    
                }
                $(document).ready(function(){

                    var scrH = $(window).height();
                    var scrHP = $("#comments").height();
                                        
                        $(window).scroll(function(){
                            var scro = $(this).scrollTop();
                            var scrHP = $("#wrap").height();
                                var scrH2 = 0;
                            scrH2 = scrH + scro;
                            var leftH = scrHP - scrH2;
                        
                        if((leftH < 0)&&($("#comments").attr("class") == "tab-pane active")){
                                
                             newPage();
                            }
                        
                        
                        });
                    
                });
          </script>

</div><!--wrap-->
<div id="push"></div>
<div id="upBlock"><img align="left" src="{{ STATIC_URL }}img/loader.gif" border="0" /></div> 
    </div>    
    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy 2013 </a>.</p>
      </div><!--container-->
         
    </div><!--footer-->
  
       
    </body>
</html>

